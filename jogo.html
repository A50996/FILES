<!doctype html>
<html lang="pt-PT">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
  <title>Pong 2 Jogadores Mobile</title>
  <style>
    html,body{
      margin:0;
      height:100%;
      background:#000;
      color:#fff;
      font-family:sans-serif;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center
    }
    canvas{
      background:#111;
      touch-action:none;
      display:none
    }
    .controls{
      position:fixed;
      bottom:0;
      width:100%;
      display:grid;
      grid-template-columns:repeat(4,1fr);
      height:30vh;
      display:none
    }
    .btn{
      background:rgba(255,255,255,0.1);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:2em;
      color:#fff;
      user-select:none
    }
    .btn:active{
      background:rgba(255,255,255,0.3)
    }
    #startBtn{
      padding:20px 40px;
      font-size:1.5em;
      background:#0a0;
      color:#fff;
      border:none;
      border-radius:10px;
      cursor:pointer
    }
  </style>
</head>
<body>
  <button id="startBtn">Start</button>
  <canvas id="game" width="800" height="500"></canvas>
  <div class="controls" id="controls">
    <div class="btn" id="p1Up">⬆️</div>
    <div class="btn" id="p1Down">⬇️</div>
    <div class="btn" id="p2Up">⬆️</div>
    <div class="btn" id="p2Down">⬇️</div>
  </div>
  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const paddleH = 80, paddleW = 12, paddleSpeed = 6;
    let p1 = {x:20, y:canvas.height/2 - paddleH/2, score:0},
        p2 = {x:canvas.width - 20 - paddleW, y:canvas.height/2 - paddleH/2, score:0};
    let ball = {x:canvas.width/2, y:canvas.height/2, r:8, vx:4, vy:3};
    let p1Up=false,p1Down=false,p2Up=false,p2Down=false;
    let gameStarted = false;

    function drawRect(x,y,w,h){ctx.fillRect(x,y,w,h);}
    function drawCircle(x,y,r){ctx.beginPath();ctx.arc(x,y,r,0,Math.PI*2);ctx.fill();}
    function resetBall(){
      ball.x=canvas.width/2;
      ball.y=canvas.height/2;
      ball.vx*=-1;
      ball.vy=3*(Math.random()>0.5?1:-1);
    }

    function update(){
      if(!gameStarted) return;
      if(p1Up) p1.y -= paddleSpeed;
      if(p1Down) p1.y += paddleSpeed;
      if(p2Up) p2.y -= paddleSpeed;
      if(p2Down) p2.y += paddleSpeed;
      p1.y = Math.max(0,Math.min(canvas.height-paddleH,p1.y));
      p2.y = Math.max(0,Math.min(canvas.height-paddleH,p2.y));

      ball.x += ball.vx;
      ball.y += ball.vy;

      if(ball.y - ball.r < 0 || ball.y + ball.r > canvas.height) ball.vy*=-1;

      if(ball.x - ball.r < p1.x + paddleW && ball.y > p1.y && ball.y < p1.y + paddleH){ball.vx*=-1;}
      if(ball.x + ball.r > p2.x && ball.y > p2.y && ball.y < p2.y + paddleH){ball.vx*=-1;}

      if(ball.x < 0){p2.score++;resetBall();}
      if(ball.x > canvas.width){p1.score++;resetBall();}
    }

    function draw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = '#fff';
      drawRect(p1.x,p1.y,paddleW,paddleH);
      drawRect(p2.x,p2.y,paddleW,paddleH);
      drawCircle(ball.x,ball.y,ball.r);
      ctx.font='20px sans-serif';
      ctx.fillText(p1.score,canvas.width/4,30);
      ctx.fillText(p2.score,3*canvas.width/4,30);
    }

    function loop(){update();draw();requestAnimationFrame(loop);}
    loop();

    function bindBtn(id,downVar){
      const btn = document.getElementById(id);
      btn.addEventListener('touchstart',()=>{window[downVar]=true;});
      btn.addEventListener('touchend',()=>{window[downVar]=false;});
    }
    bindBtn('p1Up','p1Up');
    bindBtn('p1Down','p1Down');
    bindBtn('p2Up','p2Up');
    bindBtn('p2Down','p2Down');

    async function startGame(){
      document.getElementById('startBtn').style.display = 'none';
      document.getElementById('controls').style.display = 'grid';
      canvas.style.display = 'block';
      gameStarted = true;
      if(canvas.requestFullscreen){
        await canvas.requestFullscreen();
      } else if(canvas.webkitRequestFullscreen){
        await canvas.webkitRequestFullscreen();
      }
      if(screen.orientation && screen.orientation.lock){
        try{
          await screen.orientation.lock('landscape');
        } catch(e){
          console.warn('Não foi possível bloquear orientação:', e);
        }
      }
    }

    document.getElementById('startBtn').addEventListener('click', startGame);
  </script>
</body>
</html>